---
name: codex-request-gen
description: Codex CLI 向け依頼書（md）を、漏れなく・ブレなく・実行可能な形で生成/監査するためのテンプレと作成手順。
---

# codex-request-gen（依頼書生成スキル）

目的: Codex CLI に投げる依頼を「いつも同じ品質」で作るためのスキルです。  
特に **対象ファイル指定ミス / スコープ肥大 / DoD欠落 / テスト欠落** を潰します。

---

## いつ使うか

- `codex_request_*.md` を作るとき
- Codex が勝手にスコープを広げがちなとき
- 依頼の品質を一定にしたいとき（チーム運用含む）

---

## 依頼書の必須構造（最小セット）

1) 背景（SSOTリンク）  
2) 目的 / 非目的  
3) 制約（sandbox / approval / network / shell / deps）  
4) 対象範囲（編集OK / 参照）  
5) 実装タスク（手順）  
6) DoD（受け入れ条件: チェックリスト）  
7) テスト方針（TDD推奨）  
8) 完了時の出力（変更一覧、DoD達成状況など）

---

## 生成（推奨）

```bash
python .cursor/scripts/ops.py codex-request --task-id <TASK_ID> --title "<TITLE>"
```

生成後、依頼書内の TODO を必ず埋めてください。

---

## 制約のテンプレ（推奨）

- シェル実行: 禁止（提案のみ）
- 依存追加: 禁止（必要なら相談）
- ネットワーク: 禁止（必要なら相談）
- パス: 相対パス固定
- 破壊的変更: 明示しない限り禁止
- セキュリティ: 秘密情報出力/危険操作は禁止

---

## DoDの書き方（例）

- [ ] 期待する入出力に一致する
- [ ] 境界値/異常系のテストが追加されている
- [ ] 既存テストが壊れていない
- [ ] 型/例外/ログが適切
- [ ] セキュリティ観点で危険なI/Oがない

---

## 監査（推奨）

依頼書ができたら `@request-auditor` に渡し、合格するまで直す。
